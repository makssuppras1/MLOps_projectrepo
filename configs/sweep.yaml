# Weights & Biases Sweep Configuration
# This file defines the hyperparameter search space for optimization
#
# Usage:
#   1. Create sweep: uv run wandb sweep configs/sweep.yaml
#   2. Run agent: uv run wandb agent <sweep-id>
#
# Note: The training script automatically reads hyperparameters from wandb.config
# when running in sweep mode, so no command modifications are needed.

program: src/pname/train.py
method: bayes  # Options: grid, random, bayes
metric:
  name: train/epoch_accuracy
  goal: maximize  # maximize or minimize

parameters:
  training.batch_size:
    values: [16, 32, 64, 128]

  training.optimizer.lr:
    distribution: log_uniform
    min: 0.0001
    max: 0.01

  training.epochs:
    value: 10  # Fixed for sweep, can be changed if needed

  model.dropout:
    distribution: uniform
    min: 0.2
    max: 0.8

  model.conv1.out_channels:
    values: [16, 32, 64]

  model.conv2.out_channels:
    values: [32, 64, 128]

  model.conv3.out_channels:
    values: [64, 128, 256]

early_terminate:
  type: hyperband
  min_iter: 3
  max_iter: 10
  s: 2
